---
title: 图表最终形态
categories: 博客
tags: [hexo,分享,图表,保存]
date: 2018-12-6
---

# 图表最终形态

## 常用的图表形态

常用的网页图表的展示形态一般为不含数据的html，通过ajax请求数据展示；
在服务端渲染的页面/应用有含数据html方式
图表的客户端的下载方式有pdf、图片两种，导出为html基本没有，操作查看也不方便
下面对几种图表形态试用场景和优劣进行一下简单分析

1. 不含数据html

通过ajax请求数据，然后通过html和js进行页面的渲染和交互是现在页面的主要方式。页面中图表主要也是通过这种方式。

主要优点有：

    1. 对开发友好。现在主流的前后端分离开发方式图表数据一般由后端提供，图表由前端进行开发，这种方式方便进行解
    耦，只需要定义好接口格式，即可分别开发互不干扰。对于单页面应用匹配度也较好。
    2. 比较灵活。相比数据嵌入页面的方式这种方式进行需求变更是代价更小，不涉及数据修改的地方只需要前端进行修改
    即可。对接口进行代理等统一处理时更方便灵活。
    3. 大部分情况下性能较好，这种方式页面各个部分文件都不是很大，而且页面固定可以充分利用浏览器缓存，多个请求
    数据接口也可以充分利用浏览器多个链接并发请求的优势。但是请求过多也会影响页面性能
    4. 方便接口和页面文件复用
缺点：
    1. 首屏等对页面响应时间要求较高的场景下不太适合。请求html，js之后，重新发起数据请求也需要时间对于页面本身
    不是很大对响应速度要去较高的首屏展示等场景下性能不是很好
    2. 一些情况下需要处理下跨域问题 例如需要从不同地址服务请求数据时
    3. 页面进行本地保存时再次打开基本不能正常显示。请求数据登录失效跨域请求实现等方面的限制

2. 包含数据的html

优点：

    1. 页面和数据不大时时性能好，甚至html中可以包含样式和数据，只请求html就可以显示
    2. 没有请求跨域问题
    3. 对于最近开始流行的服务端渲染SSR契合度更好（SSR对于解决单页应用首屏慢以及SEO问题有了质的提升）
    4. 页面本地保存时，由于页面包含数据基本上打开保存页面没有问题
缺点：
    1. 对于数据量比较大的页面，数据都放到html中会导致单个文件过大，增加页面加载时间
    2. 需要再web端查询接口并将数据插入生成页面中，增加了复杂度和调试难度
    3. 开发成本增加，不和服务端渲染搭配使用需要额外增加一个中间层处理数据页面中，和SSR一起使用时，需要另外熟悉
    SSR的开发调试技术，SSR相比客户端的单页应用也没有那么成熟

3. pdf、图片

pdf和图片由于基本没有交与性，一般只有客户端下载或保存图表时采用这种形式，pdf、图片都可以比较方便的由html转换成对应的格式。
pdf进行保存相对来说稍微正式一点，显示的文本可以复制，可以包含一些简单的交互和动画。但是动画和交互部分，大部分导出的插件不支持。
图片保存更方便，文件大小也更小，但是图片里面的文字不能复制，动画和交互也没有

## 综合分析

1. 对于页面中图表的形态，结合我们dataFace项目的整体架构来看，首先暂时没有考虑SSR的方式，然后数据查询接口都在云端，接口地址比较集中，使用http代理进行一些处理也比较方便，另一方面dataFace主要是图表的可视化展示，首屏展示时间的要求不是很高，而且主要时间在数据查询的方面。综合考虑页面中图表以不含数据html更加合适。
2. 图表保存的形态。这部分我们现有是pdf方式，在服务端进行html到pdf的生成，然后客户端进行下载。对于新增dataFace项目，可以考虑pdf和图片都支持的方式，对于整个报告还以pdf的方式，可以考虑客户端页面转pdf的插件，整个报告一方面基本包含了文字，另一方面整个报告查看缩放pdf有更好的效果。对于单个的图表也可以提供图片的下载方式，一般的图表库都提供了生成图片的接口。对于导出成包含数据html方式，不推荐一方面不符合普通人保存习惯，而且需要单独进行开发适配。


